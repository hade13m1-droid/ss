<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hade Portfolio</title>
  <style>
    :root{--bg:#070912;--panel:rgba(11,16,28,.72);--line:rgba(255,255,255,.14);--text:#f5f7ff;--muted:#b5bfdc;--accent:#8e77ff}
    *{box-sizing:border-box} body{margin:0;min-height:100vh;font-family:Inter,system-ui;color:var(--text);background:radial-gradient(circle at 20% 20%,#2b236b 0,#121936 45%,#070912 85%)}
    .shell{width:min(980px,100%);margin:0 auto;padding:1rem;display:grid;gap:.9rem}
    .glass{border:1px solid var(--line);border-radius:20px;background:linear-gradient(130deg,rgba(142,119,255,.14),rgba(142,119,255,.01)),var(--panel);backdrop-filter:blur(10px);box-shadow:0 18px 45px rgba(0,0,0,.4)}
    .hero{padding:1rem;display:grid;grid-template-columns:auto 1fr;gap:1rem;align-items:center}
    .avatar{width:94px;height:94px;border-radius:50%;border:1px solid var(--line);object-fit:cover}
    h1{margin:0}.tag{font-size:.72rem;letter-spacing:.15em;color:#96ffd0;margin:0 0 .3rem}.muted{color:var(--muted)}
    .panel{padding:1rem} h2{margin:0 0 .7rem;font-size:.9rem;color:var(--muted);letter-spacing:.1em;text-transform:uppercase}
    .chips,.links,.hero-actions{display:flex;flex-wrap:wrap;gap:.5rem}.chip,.links a,.btn{border:1px solid var(--line);border-radius:999px;padding:.45rem .8rem;background:rgba(255,255,255,.03);color:var(--text);text-decoration:none}
    .projects{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:.6rem}.project{border:1px solid var(--line);border-radius:12px;padding:.7rem;background:rgba(255,255,255,.03)}
    .project img{width:100%;height:130px;object-fit:cover;border-radius:10px;margin:.2rem 0 .5rem;border:1px solid var(--line)}
    .contact{display:grid;gap:.55rem} input,textarea{border-radius:12px;border:1px solid var(--line);background:rgba(255,255,255,.03);color:var(--text);padding:.6rem .68rem;font:inherit}
    .status{min-height:1.2em;color:#96ffd0} @media (max-width:760px){.hero{grid-template-columns:1fr;justify-items:center;text-align:center}}
  </style>
</head>
<body>
  <main class="shell">
    <section class="hero glass">
      <img id="pfp" class="avatar" src="/uploads/default-pfp.svg" alt="pfp" />
      <div>
        <p id="availability" class="tag">AVAILABLE NOW</p>
        <h1>Hi, I'm <span id="name">Hade</span></h1>
        <p id="description" class="muted">Loading...</p>
        <p id="place" class="muted">üìç Morocco</p>
        <div class="hero-actions">
          <a class="btn" href="/admin">Admin</a>
          <button id="music-toggle" class="btn" type="button">üîá Music Off</button>
        </div>
      </div>
    </section>

    <section class="panel glass"><h2>Skills</h2><div id="skills" class="chips"></div></section>
    <section class="panel glass"><h2>Links</h2><div id="links" class="links"></div></section>
    <section class="panel glass"><h2>Projects</h2><div id="projects" class="projects"></div></section>

    <section class="panel glass">
      <h2>Live Contact Form</h2>
      <form id="contact-form" class="contact">
        <input id="contact-name" type="text" placeholder="Name" minlength="2" required />
        <input id="contact-email" type="email" placeholder="Email" required />
        <textarea id="contact-message" rows="4" placeholder="Message" minlength="4" required></textarea>
        <button class="btn" type="submit">Send</button>
      </form>
      <p id="contact-status" class="status"></p>
    </section>
  </main>

  <audio id="bg-music" loop></audio>
  <script>
    const byId=(id)=>document.getElementById(id);
    async function api(path,opts){const r=await fetch(path,{...opts,headers:{'Content-Type':'application/json',...(opts&&opts.headers||{})}});const d=await r.json();if(!r.ok)throw new Error(d.error||'Request failed');return d}
    function render(cfg){
      document.documentElement.style.setProperty('--accent',cfg.accentColor||'#8e77ff');
      byId('name').textContent=cfg.name; byId('description').textContent=cfg.description; byId('place').textContent=`üìç ${cfg.place}`; byId('availability').textContent=cfg.availability;
      byId('pfp').src=cfg.pfp||'/uploads/default-pfp.svg';
      byId('skills').innerHTML=(cfg.skills||[]).map(s=>`<span class="chip">${s}</span>`).join('');
      byId('links').innerHTML=(cfg.links||[]).map(l=>`<a href="${l.url||'#'}" target="_blank" rel="noreferrer">${l.label||'Link'}</a>`).join('');
      byId('projects').innerHTML=(cfg.projects||[]).map(p=>`<article class="project">${p.image?`<img src="${p.image}" alt="project image">`:''}<h3>${p.title||''}</h3><p class="muted">${p.description||''}</p></article>`).join('');
      const audio=byId('bg-music'),btn=byId('music-toggle'); audio.src=cfg.music||''; let on=false;
      btn.onclick=async()=>{if(!cfg.music){btn.textContent='No music URL';return;} if(on){audio.pause();on=false;btn.textContent='üîá Music Off';return;} try{await audio.play();on=true;btn.textContent='üéµ Music On'}catch{btn.textContent='Click again'}};
    }
    byId('contact-form').addEventListener('submit',async(e)=>{e.preventDefault();const payload={name:byId('contact-name').value.trim(),email:byId('contact-email').value.trim(),message:byId('contact-message').value.trim()};
      try{await api('/api/contact',{method:'POST',body:JSON.stringify(payload)});byId('contact-status').textContent='‚úÖ Message sent';e.target.reset();}
      catch(err){byId('contact-status').textContent=`‚ùå ${err.message}`;}
    });
    api('/api/config').then(render).catch(console.error);
  </script>
</body>
</html>
